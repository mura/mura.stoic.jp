---
layout: single
title: 玄箱 Fedora化
date: 2007-08-27 01:36:38.000000000 +09:00
type: post
tags:
- Linux
- 玄箱
permalink: "/2007/08/post_122/"
---
<p>ひさしぶりに<a href="http://kuroutoshikou.com/modules/display/?iid=118">玄箱</a>なんかをいじってみたり。<br />
ずっと<a href="http://vinelinux.org/">Vine Linux</a>を入れていたけど、2.6と古すぎたので、<a href="http://fedoraproject.org/">Fedora 7</a>を入れてみた。<br />
といってもCDROMドライブも付いてないので、<a href="http://www.shinkr-webpj.jp/">できる！玄箱 Fedora化！！</a>のサイトのインストールキットを使った。<br />
インストールは手順に従ってすんなり入ったが、入れ終わってyumを使って見たら、うまくいかない。<br />
どうやらrpmの情報をうまくとれてない模様。<br />
仕方ないのでちょっぴりプログラムをいじってみた。</p>
<p><!--more--><br />
・/usr/lib/python2.5/site-packages/yum/packages.py<br />
[diff]<br />
--- packages.py.20070817        2007-07-25 23:48:56.000000000 +0900<br />
+++ packages.py 2007-08-17 13:36:29.000000000 +0900<br />
@@ -27,6 +27,7 @@<br />
import rpmUtils.arch<br />
import rpmUtils.miscutils<br />
import Errors<br />
+import md5<br />
import urlparse<br />
urlparse.uses_fragment.append("media")<br />
@@ -674,6 +675,8 @@<br />
self.pkgid = self.hdr[rpm.RPMTAG_SHA1HEADER]<br />
if not self.pkgid:<br />
self.pkgid = self.hdr[rpm.RPMTAG_SIGMD5]<br />
+        if not self.pkgid:<br />
+            self.pkgid = md5.new(str(self.hdr)).hexdigest()<br />
self.packagesize = self.hdr['size']<br />
self.__mode_cache = {}<br />
self.__prcoPopulated = False<br />
[/diff]<br />
これでなんとか動くようになった。</p>
